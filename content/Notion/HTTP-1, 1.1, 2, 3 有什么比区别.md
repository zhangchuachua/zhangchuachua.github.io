---
title: HTTP-1, 1.1, 2, 3 有什么比区别
description:
tags:
- 网络
create_date: 2025-01-23 10:09
filename: http-different.mdx
share: true
---

- HTTP/1.0
    - 单连接：每个 HTTP 请求都建立一个 TCP 连接，请求完成后立即完毕连接；这种方式效率低下，网页中多个资源需要多次建立和关闭连接；
    - 无状态：服务器不会记住客户端的上下文；每个请求都被当作全新的请求；
    - 缓存机制依靠 Expires 和 If-Modify/If-Modified-Since
- HTTP/1.1
    - 长连接（keep-alive）：同一个连接可以服用处理多个请求，不需要为每个请求重新建立连接；
    - 管线化（Pipelining）：一个 TCP 请求可以同时发送多个请求。（响应的顺序必须和请求顺序一样也就是队头阻塞，不常用）
    - 并发连接：一个域名可以有多个长连接；
    - 新增请求方法：PUT, DELETE, HEAD, OPTIONS, PATCH
    - 新增缓存机制：Cache-Control 和 ETag/If-None-Match
    - 新增 range 请求头：支持断点续传
    - 新增 Host 请求头；
    - 允许响应数据分块，有利于传输大文件；
- HTTP/2
    - 二进制协议：默认不再使用 ASCII 编码，而是使用二进制数据，这些数据统称为「帧」
    - 二进制分帧：请求和响应都会被封装成若干个带有编号的二进制帧，接收端接收到这些二进制帧后，会根据编号把它们进行组装；这是实现多路复用的关键；
    - 多路复用：废弃了 HTTP/1.1 中的管线，在同一个 TCP 连接中，因为二进制分帧，客户端和服务器端都可以同时发送多个请求或响应，不用按照顺序发送，避免了队头阻塞的问题；
        - 队头阻塞并没有彻底解决：因为 TCP 为了保证可靠传输，，如果发生了丢包；那么丢失的数据包必须等待重新传输该包，HTTP/2 出现丢包时，整个 TCP 都要等待重传，那么就会阻塞其他的所有数据包；
    - 数据流：HTTP/2 版本中，请求或响应的所有数据包被称为「数据流」，每个数据流都有唯一的 ID ；数据包在发送的时候会带上这个 ID ，这样就可以区分数据流；最后客户端还可以指定数据流的优先级；
    - 头部压缩：客户端和服务器端维护一个静态表和一个动态表；所有的信息在表里都会有记录，这样后续的请求或响应只需要发送对应的索引即可；
    - 服务器端主动推送：允许服务器端主动向客户发送数据
    - 安全性：HTTP/2 默认不会加密，但是 google 和 firefox 不支持不加密的 HTTP/2 所以 HTTP/2 可以看作是加密的，使用 TLS1.2 进行加密
- HTTP/3
    - 基于 QUIC（基于 UDP协议）协议 + 更好的多路复用：上述说了 HTTP/2 队头阻塞的问题没有完全解决，HTTP/3 使用了 QUIC 协议后可以完全解决这个问题；QUIC 协议实现了类似于 TCP 的可靠性，但是每个数据流在 QUIC 中都是独立的，丢包只会影响对应的流，不会阻塞其他流；
    - 快速握手：HTTP/2 基于 TCP 协议，需要经历三次握手建立连接，而 QUIC 可以实现使用 0 次握手或 1 次握手来建立连接；
    - 集成了 TLS 加密功能：QUIC 使用 TLS1.3 ，握手次数只需要一次（TLS1.2 需要两次）
    - 连接迁移：TCP 是按照 4 要素（客户端 IP、端口、服务器IP、端口）来确定连接的，也就是说，如果用户切换网络，TCP 连接将会断开；而 QUIC 则是让客户端生产一个 Connection ID 来区分连接。只要 id 不变，连接就不需要重新建立；
    - 丢包恢复机制优化：相较于 TCP ，QUIC 的丢包检测机制更精细，可以迅速确认丢失的包并重传；